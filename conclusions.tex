\chapter{Conclusions}
\label{chapter:conclusions}

% Tribler needs a culture change, this work tries to transform the way Tribler development is conducted...
Technical debt is a recurring problem in many large software engineering projects. The work in this thesis investigates the technical debt that has been accumulated by 111 unique contributors during the last ten years of scientific research in the area of decentralized networks. After careful analysis, we concluded that the large Tribler code base suffers from architectural impurity, lack of maintenance, an unstable and incomplete testing framework and a huge amount of technical debt, especially in the source code of the user interface.\\\\
To better understand the root causes of the incurred technical debt, we investigated the architectural evolution of Tribler over its lifespan and concluded that Tribler benefits from a new architecture that meets three requirements to reduce the amount of technical debt in the future: \emph{simplicity}, \emph{flexibility} and a \emph{focus on performance}. We started working towards this architecture by designing and implementing a new user interface, built using the mature and well-maintained Qt framework. Next, we created a developer-friendly RESTful API that could be used by external developers to communicate with the core of Tribler, libtribler. This completed the implementation of the top layer in our new proposed architecture.\\\\
While a significant amount of technical debt has been solved by removal of code related to the old user interface, the core of Tribler is still suffering. We identified and solved different kinds of technical debt. \emph{Code} debt has been identified with the SonarQube application and with some invasive refactoring efforts in the core, we reduced the estimated amount of technical debt to just over two days. \emph{Testing} debt has been handled by refactoring efforts in the test suite by splitting the tests into smaller ones while fixing many test code smells. By updating and extending our Jenkins CI environment with multi-platform tests and by improving the Tribler installers, we reduced the amount of \emph{infrastructure} debt. \emph{Architectural} debt has been reduced by breaking dependencies in the Tribler core and by the implementation of the new user interface. Finally, we have set-up a new documentation structure which reduced the amount of \emph{documentation} debt.\\\\
Prevention is the best medicine. We should learn from mistakes made during the development process over the past decade. Mandatory code reviews by other team members help to improve one's code and to get a more critical attitude towards favouring short-term decisions over long-term agreements. We also propose that it is the responsibility of every developer to write code that is sufficient covered by tests. By forcing a strictly increasing code coverage policy, realised by the addition of a code coverage check that runs for every commit, the coverage metric is under control and can gradually be improved over time. Additionally, the Pylint code analyser runs on every pull request and fails if a developer introduces code smells in the form of code style violations.\\\\
Since technical debt has a negative impact on product quality in terms of defects, performance and other structural quality issues, we identified where performance might have been lost due to the many architectural changes. By profiling Tribler on low-end devices, we identified various performance bottlenecks. We investigated the performance of the REST API and concluded that Dispersy is causing huge variations in the request response times. We assessed the usability and performance of various components in libtribler such as the local and remote search, content discovery speeds, the video streaming server and torrent lookup operations. In our final experiment, we tested Tribler on a large scale by performing a sequence of operations. This experiment focussed on failure identification and can be used as a foundation for an application testing framework.\\\\
While the work as described above is a big step in the right direction to guarantee a usable platform for future Tribler research, there is still much work to do. The performance of various components such as the video player and remote torrent handler that uses the TFTP mechanism should be investigated and improved to increase usability. Also, we found performance bottlenecks in Dispersy, in particular, a method that is responsible for over 45\% of the Tribler run time. Finally, we did not consider the lower layers in our proposed architecture: the trusted overlay. Efforts to extend the design and implement a decentralized trust network where we repel fake identities and free-riders, remains a non-trivial and challenging task.

%The main components as created in this thesis are a new user interface, built using the Qt framework, and a REST API, allowing Tribler to run on remote devices while giving developers high amounts of flexibility and ease when developing with Tribler. The testing environment has been improved with the addition of proper and stable unit tests and the tests are now executed on multiple platforms, allowing us to find defects due to platform incompatibilities earlier in the development process. Summarizing, this work transformed Tribler from an unattractive, unmaintained and untested system into a platform that is ready for development during the next decade of scientific research.\\\\
%While this is a step in the right direction, there still is a lot of work to do by the next generation of Tribler developers. \\\\
%Additional future work proposed is the implementation of the trust walker, which will become the foundations of the Tribler platform. This way, the Dispersy framework could be removed, allowing the deletion of much legacy code. Although not the main subject of this thesis, the amount of accumulated debt in Dispersy is also rather high. From a performance perspective, research should be conducted to see how the performance on low-end embedded devices could be improved. Since our main performance bottleneck is the limited amount of CPU power in a specific core, one of the proposed solutions is to increase utilization of multi-core architectures. This can be achieved by splitting the architecture of Tribler in separate components that can independently run on several cores, however, this requires one to think very carefully about the final design and communication structure.